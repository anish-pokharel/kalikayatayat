<div class="companies-container">
  <!-- Page Header -->
  <div class="page-header">
    <h1>Companies Management</h1>
    <button class="btn-primary" (click)="openAddModal()">
      <span class="icon">‚ûï</span> Add New Company
    </button>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="search-box">
      <span class="search-icon">üîç</span>
      <input 
        type="text" 
        placeholder="Search companies..." 
        [(ngModel)]="searchTerm"
        (input)="onSearch()"
      >
    </div>
    
    <div class="status-filter">
      <select [(ngModel)]="selectedStatus" (change)="onStatusFilter()">
        <option value="all">All Status</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
    </div>
  </div>

  <!-- Companies Table -->
  <div class="table-container">
    <table class="companies-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Company Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>City</th>
          <th>GSTIN</th>
          <th>Total Buses</th>
          <th>Status</th>
          <th>Joined Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let company of filteredCompanies">
          <td>#{{ company.id }}</td>
          <td class="company-name">
            <strong>{{ company.name }}</strong>
          </td>
          <td>{{ company.email }}</td>
          <td>{{ company.phone }}</td>
          <td>{{ company.city }}, {{ company.state }}</td>
          <td>{{ company.gstin }}</td>
          <td>{{ company.totalBuses }}</td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(company.status)">
              {{ company.status }}
            </span>
          </td>
          <td>{{ company.joinedDate | date }}</td>
          <td class="actions">
            <button class="btn-icon" (click)="openViewModal(company)" title="View Details">
              üëÅÔ∏è
            </button>
            <button class="btn-icon" (click)="openEditModal(company)" title="Edit">
              ‚úèÔ∏è
            </button>
            <button class="btn-icon" (click)="toggleStatus(company)" [title]="company.status === 'active' ? 'Deactivate' : 'Activate'">
              {{ company.status === 'active' ? 'üî¥' : 'üü¢' }}
            </button>
            <button class="btn-icon" (click)="openDeleteModal(company)" title="Delete">
              üóëÔ∏è
            </button>
          </td>
        </tr>
        <tr *ngIf="filteredCompanies.length === 0">
          <td colspan="10" class="no-data">No companies found</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Add Company Modal -->
  <div class="modal" *ngIf="showAddModal">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h2>Add New Company</h2>
        <button class="close-btn" (click)="closeAddModal()">√ó</button>
      </div>
      
      <div class="modal-body">
        <form>
          <div class="form-row">
            <div class="form-group">
              <label>Company Name *</label>
              <input type="text" [(ngModel)]="newCompany.name" name="name" required>
            </div>
            <div class="form-group">
              <label>Email *</label>
              <input type="email" [(ngModel)]="newCompany.email" name="email" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Phone *</label>
              <input type="text" [(ngModel)]="newCompany.phone" name="phone" required>
            </div>
            <div class="form-group">
              <label>GSTIN *</label>
              <input type="text" [(ngModel)]="newCompany.gstin" name="gstin" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Address</label>
              <input type="text" [(ngModel)]="newCompany.address" name="address">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>City</label>
              <input type="text" [(ngModel)]="newCompany.city" name="city">
            </div>
            <div class="form-group">
              <label>State</label>
              <input type="text" [(ngModel)]="newCompany.state" name="state">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Total Buses</label>
              <input type="number" [(ngModel)]="newCompany.totalBuses" name="totalBuses">
            </div>
            <div class="form-group">
              <label>Status</label>
              <select [(ngModel)]="newCompany.status" name="status">
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeAddModal()">Cancel</button>
        <button class="btn-primary" (click)="saveCompany()">Save Company</button>
      </div>
    </div>
  </div>

  <!-- View Company Modal -->
  <div class="modal" *ngIf="showViewModal && selectedCompany">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Company Details</h2>
        <button class="close-btn" (click)="closeViewModal()">√ó</button>
      </div>
      
      <div class="modal-body">
        <div class="details-grid">
          <div class="detail-item">
            <label>Company ID</label>
            <p>#{{ selectedCompany.id }}</p>
          </div>
          <div class="detail-item">
            <label>Company Name</label>
            <p>{{ selectedCompany.name }}</p>
          </div>
          <div class="detail-item">
            <label>Email</label>
            <p>{{ selectedCompany.email }}</p>
          </div>
          <div class="detail-item">
            <label>Phone</label>
            <p>{{ selectedCompany.phone }}</p>
          </div>
          <div class="detail-item">
            <label>GSTIN</label>
            <p>{{ selectedCompany.gstin }}</p>
          </div>
          <div class="detail-item">
            <label>Address</label>
            <p>{{ selectedCompany.address }}, {{ selectedCompany.city }}, {{ selectedCompany.state }}</p>
          </div>
          <div class="detail-item">
            <label>Total Buses</label>
            <p>{{ selectedCompany.totalBuses }}</p>
          </div>
          <div class="detail-item">
            <label>Status</label>
            <p>
              <span class="status-badge" [ngClass]="getStatusClass(selectedCompany.status)">
                {{ selectedCompany.status }}
              </span>
            </p>
          </div>
          <div class="detail-item">
            <label>Joined Date</label>
            <p>{{ selectedCompany.joinedDate | date }}</p>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeViewModal()">Close</button>
        <button class="btn-primary" (click)="openEditModal(selectedCompany); closeViewModal()">Edit</button>
      </div>
    </div>
  </div>

  <!-- Edit Company Modal -->
  <div class="modal" *ngIf="showEditModal && selectedCompany">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h2>Edit Company</h2>
        <button class="close-btn" (click)="closeEditModal()">√ó</button>
      </div>
      
      <div class="modal-body">
        <form>
          <div class="form-row">
            <div class="form-group">
              <label>Company Name *</label>
              <input type="text" [(ngModel)]="selectedCompany.name" name="editName" required>
            </div>
            <div class="form-group">
              <label>Email *</label>
              <input type="email" [(ngModel)]="selectedCompany.email" name="editEmail" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Phone *</label>
              <input type="text" [(ngModel)]="selectedCompany.phone" name="editPhone" required>
            </div>
            <div class="form-group">
              <label>GSTIN *</label>
              <input type="text" [(ngModel)]="selectedCompany.gstin" name="editGstin" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Address</label>
              <input type="text" [(ngModel)]="selectedCompany.address" name="editAddress">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>City</label>
              <input type="text" [(ngModel)]="selectedCompany.city" name="editCity">
            </div>
            <div class="form-group">
              <label>State</label>
              <input type="text" [(ngModel)]="selectedCompany.state" name="editState">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Total Buses</label>
              <input type="number" [(ngModel)]="selectedCompany.totalBuses" name="editTotalBuses">
            </div>
            <div class="form-group">
              <label>Status</label>
              <select [(ngModel)]="selectedCompany.status" name="editStatus">
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
            </div>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeEditModal()">Cancel</button>
        <button class="btn-primary" (click)="updateCompany()">Update Company</button>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal modal-sm" *ngIf="showDeleteModal && selectedCompany">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Confirm Delete</h2>
        <button class="close-btn" (click)="closeDeleteModal()">√ó</button>
      </div>
      
      <div class="modal-body">
        <p>Are you sure you want to delete company <strong>"{{ selectedCompany.name }}"</strong>?</p>
        <p class="warning-text">This action cannot be undone.</p>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" (click)="closeDeleteModal()">Cancel</button>
        <button class="btn-danger" (click)="confirmDelete()">Delete</button>
      </div>
    </div>
  </div>
</div>